import{b as E,d as S,e as O,f as b,g as y,h as P,i as te,j as w}from"./chunk-3GP4MR7V.js";import{a as j,b as Q,c as $,d as G,e as U,f as H,g as X,h as Y,i as Z,j as J,k as K,l as ee}from"./chunk-XGW7LVPC.js";import{D as B}from"./chunk-URRIIX2J.js";import{$ as C,Ia as s,Lb as R,Ma as L,Mb as z,Nb as A,Ra as I,Va as f,W as v,a as q,ab as m,b as T,c as W,cb as i,db as r,eb as N,fb as F,g as V,gb as x,hb as c,ia as M,ib as l,ja as h,jb as _,lb as p,mb as g,nb as u}from"./chunk-W4TODVNY.js";var D=class d{constructor(t){this.firestore=t}logAction(t,e,a){return{action:t,userId:e,timestamp:new Date,details:a}}getLogs(){let t=b(this.firestore,"logs");return S(t,{idField:"id"})}addLog(t){let e=b(this.firestore,"logs");return O(e,t)}deleteLog(t){let e=P(this.firestore,`logs/${t}`);return y(e)}updateLog(t,e){let a=P(this.firestore,`logs/${t}`);return w(a,e)}static \u0275fac=function(e){return new(e||d)(C(E))};static \u0275prov=v({token:d,factory:d.\u0275fac,providedIn:"root"})};var k=class d{constructor(t,e,a){this.firestore=t;this.logsService=e;this.auth=a}getMadeiras(){let t=b(this.firestore,"madeiras");return S(t,{idField:"id"})}addMadeira(t){let e=b(this.firestore,"madeiras"),a=this.logsService.logAction(`
            Adicionando Nome: ${t.nome} 
            Tamanho: ${t.tamanho.comprimento} x ${t.tamanho.espessura} x ${t.tamanho.largura}, 
            Quantidade ${t.quantidade}`,`${this.auth.currentUser?.email}`,"ADD");return this.logsService.addLog(a),O(e,t)}deleteMadeira(t){return V(this,null,function*(){let e=P(this.firestore,`madeiras/${t}`),n=(yield te(e)).data();if(n){let o=this.logsService.logAction(`
                Removendo Nome: ${n.nome} 
                Tamanho: ${n.tamanho.comprimento} x ${n.tamanho.espessura} x ${n.tamanho.largura}, 
                Quantidade ${n.quantidade}`,`${this.auth.currentUser?.email}`,"REMOVE");this.logsService.addLog(o)}return y(e)})}updateMadeira(t,e){let a=P(this.firestore,`madeiras/${t}`);return this.logsService.addLog(this.logsService.logAction(`EDIT madeira ${e.id} para -> ${e.nome} tamanho ${e.tamanho} quantidade ${e.quantidade}`,`${this.auth.currentUser?.email}`,"REMOVE")),w(a,e)}static \u0275fac=function(e){return new(e||d)(C(E),C(D),C(B))};static \u0275prov=v({token:d,factory:d.\u0275fac,providedIn:"root"})};function de(d,t){if(d&1&&(i(0,"option",20),l(1),r()),d&2){let e=t.$implicit;m("value",e),s(),_(e)}}function le(d,t){if(d&1&&(i(0,"option",20),l(1),r()),d&2){let e=t.$implicit;m("value",e),s(),_(e)}}function se(d,t){if(d&1&&(i(0,"option",20),l(1),r()),d&2){let e=t.$implicit;m("value",e),s(),_(e)}}function me(d,t){if(d&1&&(i(0,"option",20),l(1),r()),d&2){let e=t.$implicit;m("value",e),s(),_(e)}}function ce(d,t){if(d&1){let e=F();i(0,"div",21)(1,"div",22)(2,"h3",23),l(3,"Editar Madeira"),r(),i(4,"label",24),l(5," Nome: "),i(6,"select",25),u("ngModelChange",function(n){M(e);let o=c();return g(o.madeiraEditando.nome,n)||(o.madeiraEditando.nome=n),h(n)}),i(7,"option",5),l(8,"Cor da madeira"),r(),f(9,se,2,2,"option",6),r()(),i(10,"label",24)(11,"div",26)(12,"input",27),u("ngModelChange",function(n){M(e);let o=c();return g(o.madeiraEditando.tamanho.comprimento,n)||(o.madeiraEditando.tamanho.comprimento=n),h(n)}),r(),i(13,"p",28),l(14,"x"),r(),i(15,"select",25),u("ngModelChange",function(n){M(e);let o=c();return g(o.madeiraEditando.tamanho.espessura,n)||(o.madeiraEditando.tamanho.espessura=n),h(n)}),i(16,"option",5),l(17,"Espessura"),r(),f(18,me,2,2,"option",6),r(),i(19,"p",28),l(20,"x"),r(),i(21,"input",29),u("ngModelChange",function(n){M(e);let o=c();return g(o.madeiraEditando.tamanho.largura,n)||(o.madeiraEditando.tamanho.largura=n),h(n)}),r()()(),i(22,"label",24),l(23," Quantidade: "),i(24,"input",30),u("ngModelChange",function(n){M(e);let o=c();return g(o.madeiraEditando.quantidade,n)||(o.madeiraEditando.quantidade=n),h(n)}),r()(),i(25,"div",31)(26,"button",32),x("click",function(){M(e);let n=c();return h(n.salvarEdicao())}),l(27,"Salvar"),r(),i(28,"button",33),x("click",function(){M(e);let n=c();return h(n.cancelarEdicao())}),l(29,"Cancelar"),r()()()()}if(d&2){let e=c();s(6),p("ngModel",e.madeiraEditando.nome),s(3),m("ngForOf",e.catalogoMDF_MDP),s(3),p("ngModel",e.madeiraEditando.tamanho.comprimento),s(3),p("ngModel",e.madeiraEditando.tamanho.espessura),s(3),m("ngForOf",e.espessurasMDF_MDP),s(3),p("ngModel",e.madeiraEditando.tamanho.largura),s(3),p("ngModel",e.madeiraEditando.quantidade)}}function pe(d,t){if(d&1){let e=F();i(0,"tr")(1,"td"),l(2),r(),i(3,"td"),l(4),r(),i(5,"td"),l(6),r(),i(7,"td")(8,"button",34),x("click",function(){let n=M(e).$implicit,o=c();return h(o.editar(n))}),l(9,"Editar"),r(),i(10,"button",35),x("click",function(){let n=M(e).$implicit,o=c();return h(o.excluir(n.id))}),l(11,"Excluir"),r()()()}if(d&2){let e=t.$implicit;s(2),_(e.nome),s(2),_(e.tamanho),s(2),_(e.quantidade)}}var ne=class d{constructor(t){this.madeiraService=t}madeiras=[];novaMadeira=this.criarMadeiraVazia();madeiraEditando=this.criarMadeiraVazia();madeiraSelecionada="";editarando=!1;tamanho={comprimento:0,espessura:0,largura:0};catalogoMDF_MDP=["MDP Branco TX","MDP Blues ES","MDP Boho ES","MDP Camurca ES","MDP Cinza ES","MDP Country EW","MDP Cristal ES","MDP Eucalipto ES","MDP Folk EW","MDP Grecia ES","MDP Hard Rock ES","MDP Moscata GR","MDP Nude ES","MDP Off ES","MDP Preto TC","MDP Roots GR","MDP Zen ES","MDP Carvalho Nord ES","MDP Carvalho Campestre ES","MDP Oasis ES","MDP Carvalho Mel ES"];espessurasMDF_MDP=[6,15,18,20,25,30];ngOnInit(){this.carregarMadeiras()}adicionar(){this.novaMadeira={nome:this.novaMadeira.nome,tamanho:this.tamanho,quantidade:this.novaMadeira.quantidade},this.validaNome(this.novaMadeira.nome)&&this.validaQuantidade(this.novaMadeira.quantidade)&&this.validaTamanho(this.tamanho)?this.verificaPeca(this.novaMadeira)?this.atualizarQuantidadeExistente(this.novaMadeira):this.madeiraService.addMadeira(this.novaMadeira).then(()=>{this.novaMadeira=this.criarMadeiraVazia()}):alert("Madeira n\xE3o adicionada, tente novamente!")}excluir(t){confirm("Tem certeza que deseja excluir esta madeira?")&&this.madeiras.find(a=>a.id===t)&&this.madeiraService.deleteMadeira(t)}editar(t){this.madeiraEditando=q({},t),this.editarando=!0}salvarEdicao(){if(this.madeiraEditando.id){let t=this.madeiraEditando,{id:e}=t,a=W(t,["id"]),n=T(q({},a),{nome:a.nome,tamanho:a.tamanho,quantidade:a.quantidade});this.madeiraService.updateMadeira(e,n).then(()=>{this.editarando=!1})}}cancelarEdicao(){this.editarando=!1}carregarMadeiras(){this.madeiraService.getMadeiras().subscribe(t=>this.madeiras=t)}criarMadeiraVazia(){return{nome:"",tamanho:{espessura:0,comprimento:0,largura:0},quantidade:0}}atualizarQuantidadeExistente(t){this.madeiras.forEach(e=>{e.nome===t.nome&&e.tamanho===t.tamanho&&this.madeiraService.updateMadeira(e.id,{quantidade:e.quantidade+t.quantidade})})}validaNome(t){return this.catalogoMDF_MDP.includes(t)?!0:(alert("Nome Invalido"),!1)}validaQuantidade(t){return t>0?!0:(alert("Quantidade Menor ou igual a 0"),!1)}validaTamanho(t){let e=[6,15,18,20,25,30];return t.comprimento>0&&t.comprimento<2700&&t.largura>0&&t.largura<2700&&e.includes(t.espessura)?!0:(alert("Tamanho inv\xE1lido! Comprimento e largura devem ser entre 1 e 2699, e espessura deve ser uma das: "+e.join(", ")),!1)}verificaPeca(t){return this.madeiras.some(e=>e.nome===t.nome&&e.tamanho===t.tamanho)}static \u0275fac=function(e){return new(e||d)(L(k))};static \u0275cmp=I({type:d,selectors:[["app-madeiras"]],decls:39,vars:9,consts:[[1,"painel-madeiras"],[1,"painel-title"],[1,"form-madeira",3,"ngSubmit"],[1,"form-group"],["id","madeira","name","madeira","required","",1,"form-input",3,"ngModelChange","ngModel"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","tamanho-group"],["type","number","name","Comprimento","placeholder","Comprimento","required","",1,"form-input",3,"ngModelChange","ngModel"],["id","Espessura","name","Espessura","required","",1,"form-input",3,"ngModelChange","ngModel"],["name","largura","placeholder","largura","required","",1,"form-input",3,"ngModelChange","ngModel"],["name","quantidade","type","number","placeholder","Quantidade de Pe\xE7as","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","submit",1,"btn-adicionar"],["class","modal",4,"ngIf"],["action","Seach",1,"form-search"],["type","text",1,"form-input-search"],["type","submit",1,"btn-search"],[1,"scrollable-table"],[1,"tabela-madeiras"],[4,"ngFor","ngForOf"],[3,"value"],[1,"modal"],[1,"modal-content"],[1,"modal-title"],[1,"modal-label"],["id","madeira","name","madeira","required","",1,"select-madeira",3,"ngModelChange","ngModel"],[1,"tamanho","tamanho-group"],["type","number","name","Comprimento","placeholder","Comprimento","required","",1,"input-tamanho",3,"ngModelChange","ngModel"],[1,"tamanho-separador"],["type","number","name","Largura","placeholder","Largura","required","",1,"input-tamanho",3,"ngModelChange","ngModel"],["type","number",1,"input-quantidade",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn-salvar",3,"click"],[1,"btn-cancelar",3,"click"],[1,"btn-editar",3,"click"],[1,"btn-excluir",3,"click"]],template:function(e,a){e&1&&(i(0,"section",0)(1,"h2",1),l(2,"Controle de Madeiras"),r(),i(3,"form",2),x("ngSubmit",function(){return a.adicionar()}),i(4,"div",3)(5,"select",4),u("ngModelChange",function(o){return g(a.novaMadeira.nome,o)||(a.novaMadeira.nome=o),o}),i(6,"option",5),l(7,"Cor da madeira"),r(),f(8,de,2,2,"option",6),r()(),i(9,"div",7)(10,"input",8),u("ngModelChange",function(o){return g(a.tamanho.comprimento,o)||(a.tamanho.comprimento=o),o}),r(),i(11,"select",9),u("ngModelChange",function(o){return g(a.madeiraEditando.tamanho.espessura,o)||(a.madeiraEditando.tamanho.espessura=o),o}),i(12,"option",5),l(13,"Espessura"),r(),f(14,le,2,2,"option",6),r(),i(15,"input",10),u("ngModelChange",function(o){return g(a.tamanho.largura,o)||(a.tamanho.largura=o),o}),r()(),i(16,"div",3)(17,"input",11),u("ngModelChange",function(o){return g(a.novaMadeira.quantidade,o)||(a.novaMadeira.quantidade=o),o}),r()(),i(18,"button",12),l(19,"Adicionar"),r()(),f(20,ce,30,7,"div",13),i(21,"form",14),N(22,"input",15),i(23,"button",16),l(24,"Procurar"),r()(),i(25,"div",17)(26,"table",18)(27,"thead")(28,"tr")(29,"th"),l(30,"Nome"),r(),i(31,"th"),l(32,"Tamanho"),r(),i(33,"th"),l(34,"Quantidade"),r(),i(35,"th"),l(36,"A\xE7\xF5es"),r()()(),i(37,"tbody"),f(38,pe,12,3,"tr",19),r()()()()),e&2&&(s(5),p("ngModel",a.novaMadeira.nome),s(3),m("ngForOf",a.catalogoMDF_MDP),s(2),p("ngModel",a.tamanho.comprimento),s(),p("ngModel",a.madeiraEditando.tamanho.espessura),s(3),m("ngForOf",a.espessurasMDF_MDP),s(),p("ngModel",a.tamanho.largura),s(2),p("ngModel",a.novaMadeira.quantidade),s(3),m("ngIf",a.editarando),s(18),m("ngForOf",a.madeiras))},dependencies:[A,R,z,ee,H,Z,J,j,X,Y,Q,$,K,U,G],styles:[".painel-madeiras[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:20px;padding:20px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a}.painel-title[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:40px;font-size:48px}.form-madeira[_ngcontent-%COMP%], .form-search[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;align-items:center}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;width:100%}.tamanho-group[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:center;gap:5px}.form-input[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;width:calc(100% - 20px)}.form-input-search[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;display:flex;flex-direction:row;width:80%}.input-tamanho[_ngcontent-%COMP%]{width:80px}.input-quantidade[_ngcontent-%COMP%]{width:100px}.input-search[_ngcontent-%COMP%]{flex:1;min-width:150px}.select-madeira[_ngcontent-%COMP%]{min-width:120px}.tamanho-separador[_ngcontent-%COMP%]{margin:0 5px}.btn-adicionar[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s}.btn-search[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s;width:17.5%}.btn-adicionar[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-adicionar[_ngcontent-%COMP%]:hover, .btn-salvar[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-search[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff}.btn-search[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-editar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;margin:0 8px}.btn-editar[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-excluir[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;margin:0 8px}.btn-excluir[_ngcontent-%COMP%]:hover, .btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#da190b}.scrollable-table[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;margin-top:20px}.tabela-madeiras[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabela-madeiras[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:20vw}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:999;padding:10px}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:20px;max-width:750px;width:100%;box-shadow:0 6px 20px #00000040;animation:_ngcontent-%COMP%_slideIn .3s ease-in-out;display:flex;flex-direction:column}.modal-title[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:20px}.modal-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;font-weight:700;color:#444}.modal-label[_ngcontent-%COMP%]   .tamanho-group[_ngcontent-%COMP%]{margin-top:8px}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:10px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 800px){.modal-content[_ngcontent-%COMP%]{max-width:98vw}.tabela-madeiras[_ngcontent-%COMP%]{min-width:400px}}@media (max-width: 600px){.painel-madeiras[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]{padding:10px}.form-madeira[_ngcontent-%COMP%], .form-search[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%], .tamanho-group[_ngcontent-%COMP%], .input-tamanho[_ngcontent-%COMP%], .input-quantidade[_ngcontent-%COMP%], .input-search[_ngcontent-%COMP%], .select-madeira[_ngcontent-%COMP%]{width:100%;min-width:unset}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-adicionar[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{width:100%;margin:5px 0}}"]})};export{ne as MadeirasComponent};
