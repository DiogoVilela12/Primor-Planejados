import{a as ee}from"./chunk-XLIY6UAD.js";import{f as H,h as J,i as K,j as E,k as X,l as O,m as S,p as Z}from"./chunk-WBFAZXNE.js";import{b as z,c as B,d as A,e as L,f as j,g as Q,h as $,j as R,k as U,l as Y,n as G}from"./chunk-7KJUW2YA.js";import{D}from"./chunk-HRPHVETK.js";import{$ as M,$a as v,Ia as d,Ma as V,Ob as I,Pb as T,Ra as N,Sb as W,Va as C,W as q,a as x,ab as _,c as k,cb as i,db as a,eb as w,fb as y,g as b,gb as h,hb as s,ia as g,ib as l,ja as m,jb as F,mb as p,nb as u,ob as f}from"./chunk-AOBJMOM4.js";var P=class c{constructor(t,e,n){this.firestore=t;this.logsService=e;this.auth=n}getFerragens(){let t=E(this.firestore,"ferragens");return J(t,{idField:"id"})}getFerragemById(t){return b(this,null,function*(){let e=O(this.firestore,`ferragens/${t}`),n=yield S(e);if(n.exists())return x({id:n.id},n.data())})}addFerragem(t){let e=E(this.firestore,"ferragens"),n=this.logsService.logAction(`Adicionando Ferragem: Nome: ${t.nome}, Especifica\xE7\xE3o: ${t.especificacao}, Quantidade: ${t.quantidade}`,`${this.auth.currentUser?.email}`,"ADD");return this.logsService.addLog(n),K(e,t)}deleteFerragem(t){return b(this,null,function*(){let e=O(this.firestore,`ferragens/${t}`),r=(yield S(e)).data();if(r){let o=this.logsService.logAction(`Removendo Ferragem: Nome: ${r.nome}, Especifica\xE7\xE3o: ${r.especificacao}, Quantidade: ${r.quantidade}`,`${this.auth.currentUser?.email}`,"REMOVE");this.logsService.addLog(o)}return X(e)})}updateFerragem(t,e,n){let r=O(this.firestore,`ferragens/${t}`);if(!e)throw new Error("ferragemAntiga is undefined");return this.logsService.addLog(this.logsService.logAction(`EDIT Ferragem: ${e.nome}, Especifica\xE7\xE3o: ${e.especificacao}, Quantidade: ${e.quantidade} 
        Para -> Nome: ${n.nome}, Especifica\xE7\xE3o: ${n.especificacao}, Quantidade: ${n.quantidade}`,`${this.auth.currentUser?.email}`,"EDIT")),Z(r,n)}static \u0275fac=function(e){return new(e||c)(M(H),M(ee),M(D))};static \u0275prov=q({token:c,factory:c.\u0275fac,providedIn:"root"})};function oe(c,t){if(c&1&&w(0,"option",16),c&2){let e=t.$implicit;_("value",e)}}function ie(c,t){if(c&1&&w(0,"option",16),c&2){let e=t.$implicit;_("value",e)}}function ae(c,t){if(c&1){let e=y();i(0,"tr")(1,"td"),l(2),a(),i(3,"td"),l(4),a(),i(5,"td"),l(6),a(),i(7,"td")(8,"button",17),h("click",function(){let r=g(e).$implicit,o=s();return m(o.editar(r))}),l(9,"Editar"),a(),i(10,"button",18),h("click",function(){let r=g(e).$implicit,o=s();return m(o.excluir(r.id))}),l(11,"Excluir"),a()()()}if(c&2){let e=t.$implicit;d(2),F(e.nome),d(2),F(e.especificacao),d(2),F(e.quantidade)}}function ce(c,t){if(c&1){let e=y();i(0,"div",19)(1,"div",20)(2,"h3",21),l(3,"Editar Ferragem"),a(),i(4,"label",22)(5,"input",23),f("ngModelChange",function(r){g(e);let o=s();return u(o.ferragemEditando.nome,r)||(o.ferragemEditando.nome=r),m(r)}),a()(),i(6,"label",22)(7,"input",24),f("ngModelChange",function(r){g(e);let o=s();return u(o.ferragemEditando.especificacao,r)||(o.ferragemEditando.especificacao=r),m(r)}),a()(),i(8,"label",22)(9,"input",25),f("ngModelChange",function(r){g(e);let o=s();return u(o.ferragemEditando.quantidade,r)||(o.ferragemEditando.quantidade=r),m(r)}),a()(),i(10,"div",26)(11,"button",27),h("click",function(){g(e);let r=s();return m(r.salvarEdicao())}),l(12,"Salvar"),a(),i(13,"button",28),h("click",function(){g(e);let r=s();return m(r.cancelarEdicao())}),l(14,"Cancelar"),a()()()()}if(c&2){let e=s();d(5),p("ngModel",e.ferragemEditando.nome),d(2),p("ngModel",e.ferragemEditando.especificacao),d(2),p("ngModel",e.ferragemEditando.quantidade)}}var te=class c{constructor(t){this.ferragemService=t}ferragens=[];novaFerragem=this.criarFerragemVazia();ferragemEditando=this.criarFerragemVazia();editando=!1;catalogoFerragens=[];catalogoEspecificacoes=[];termoBusca="";ngOnInit(){this.carregarFerragens()}adicionar(){if(!this.validaNome(this.novaFerragem.nome)||!this.validaQuantidade(this.novaFerragem.quantidade))return;let t=x({},this.novaFerragem);this.verificaExistente(t)?this.atualizarQuantidadeExistente(t):this.ferragemService.addFerragem(t).then(()=>{this.novaFerragem=this.criarFerragemVazia()})}editar(t){this.ferragemEditando=x({},t),this.editando=!0}cancelarEdicao(){this.editando=!1}salvarEdicao(){return b(this,null,function*(){if(!this.ferragemEditando.id)return;let r=this.ferragemEditando,{id:t}=r,e=k(r,["id"]),n=yield this.ferragemService.getFerragemById(t);this.ferragemService.updateFerragem(t,n,e).then(()=>{this.editando=!1})})}excluir(t){confirm("Tem certeza que deseja excluir esta ferragem?")&&this.ferragemService.deleteFerragem(t)}buscarFerragem(){let t=this.termoBusca.trim().toLowerCase();if(t==="")this.carregarFerragens(),console.log(this.ferragens.length);else{let e=this.ferragens.filter(n=>n.nome.toLowerCase().includes(t));e.length===0&&e.length!=this.ferragens.length?this.carregarFerragens():this.ferragens=e}}carregarFerragens(){this.ferragemService.getFerragens().subscribe(t=>{this.ferragens=t;let e=new Set(t.map(r=>r.nome));this.catalogoFerragens=Array.from(e);let n=new Set(t.map(r=>r.especificacao));this.catalogoEspecificacoes=Array.from(n)})}criarFerragemVazia(){return{nome:"",especificacao:"",quantidade:0}}atualizarQuantidadeExistente(t){this.ferragens.forEach(e=>b(this,null,function*(){if(e.nome===t.nome&&e.especificacao===t.especificacao){let n=yield this.ferragemService.getFerragemById(e.id);this.ferragemService.updateFerragem(e.id,n,{quantidade:Number(e.quantidade)+Number(t.quantidade)})}}))}validaNome(t){return!0}validaQuantidade(t){return Number(t)>0?!0:(alert("Quantidade deve ser maior que 0!"),!1)}verificaExistente(t){return this.ferragens.some(e=>e.nome===t.nome&&e.especificacao===t.especificacao)}static \u0275fac=function(e){return new(e||c)(V(P))};static \u0275cmp=N({type:c,selectors:[["app-ferragens"]],decls:30,vars:10,consts:[[1,"controle"],[1,"controle_title"],[1,"controle_container",3,"ngSubmit"],["name","nome","type","text","placeholder","Nome da Ferragem","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["id","catalogoFerragens_list",1,"catalogoFerragens_list"],["class","catalogoMDF_MDP_list_item",3,"value",4,"ngFor","ngForOf"],["name","nome","type","text","placeholder","Especifica\xE7\xE3o","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["id","catalogoEspecificacoes_list",1,"catalogoEspecificacoes_list"],["name","quantidade","type","number","placeholder","Quantidade","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["type","submit",1,"btn-adicionar"],[1,"controle_container"],["type","text","placeholder","Buscar Ferragem",1,"controle_container_input",3,"ngModelChange","input","ngModel"],[1,"scrollable-table"],[1,"tabela-madeiras"],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"catalogoMDF_MDP_list_item",3,"value"],[1,"btn-editar",3,"click"],[1,"btn-excluir",3,"click"],[1,"modal"],[1,"modal-content"],[1,"modal-title"],[1,"modal-label"],["type","text","name","nome","placeholder","Nome da Ferragem","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["type","text","name","especificacao","placeholder","Especifica\xE7\xE3o","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["type","number","name","quantidade","placeholder","Quantidade","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn-salvar",3,"click"],[1,"btn-cancelar",3,"click"]],template:function(e,n){e&1&&(i(0,"section",0)(1,"h2",1),l(2,"Controle de Ferragens"),a(),i(3,"form",2),h("ngSubmit",function(){return n.adicionar()}),i(4,"input",3),f("ngModelChange",function(o){return u(n.novaFerragem.nome,o)||(n.novaFerragem.nome=o),o}),a(),i(5,"datalist",4),C(6,oe,1,1,"option",5),a(),i(7,"input",6),f("ngModelChange",function(o){return u(n.novaFerragem.especificacao,o)||(n.novaFerragem.especificacao=o),o}),a(),i(8,"datalist",7),C(9,ie,1,1,"option",5),a(),i(10,"input",8),f("ngModelChange",function(o){return u(n.novaFerragem.quantidade,o)||(n.novaFerragem.quantidade=o),o}),a(),i(11,"button",9),l(12,"Adicionar"),a()(),i(13,"div",10)(14,"input",11),f("ngModelChange",function(o){return u(n.termoBusca,o)||(n.termoBusca=o),o}),h("input",function(){return n.buscarFerragem()}),a()(),i(15,"div",12)(16,"table",13)(17,"thead")(18,"tr")(19,"th"),l(20,"Nome"),a(),i(21,"th"),l(22,"Especifica\xE7\xE3o"),a(),i(23,"th"),l(24,"Quantidade"),a(),i(25,"th"),l(26,"A\xE7\xF5es"),a()()(),i(27,"tbody"),C(28,ae,12,3,"tr",14),a()()()(),C(29,ce,15,3,"div",15)),e&2&&(d(4),p("ngModel",n.novaFerragem.nome),v("list","catalogoFerragens_list"),d(2),_("ngForOf",n.catalogoFerragens),d(),p("ngModel",n.novaFerragem.especificacao),v("list","catalogoEspecificacoes_list"),d(2),_("ngForOf",n.catalogoEspecificacoes),d(),p("ngModel",n.novaFerragem.quantidade),d(4),p("ngModel",n.termoBusca),d(14),_("ngForOf",n.ferragens),d(),_("ngIf",n.editando))},dependencies:[W,I,T,G,Q,R,U,z,$,B,A,Y,j,L],styles:['.controle[_ngcontent-%COMP%]{background-color:#f9f9f9;margin:20px;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;display:flex;align-items:center;flex-direction:column;justify-content:center}.controle_title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.controle_title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.controle_container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;flex-direction:row;width:100%;gap:10px;margin-bottom:20px}.controle_container_input[_ngcontent-%COMP%]{background-color:#fff;color:#333;border:1px solid #ccc;width:100%;padding:10px;font-size:14px;border-radius:4px;appearance:none;-webkit-appearance:none;-moz-appearance:none;box-sizing:border-box;outline:none;transition:border-color .2s}.controle_container_input[_ngcontent-%COMP%]:focus{border-color:#2196f3}.controle_container_input[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#222}.controle_container_tamanho[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;gap:10px;padding:16px}.form-input-search[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;display:flex;flex-direction:row;width:100%}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;margin-right:10px}.checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;width:18px;height:18px;border:2px solid #ccc;border-radius:4px;background-color:#fff;position:relative;cursor:pointer;transition:border-color .3s,background-color .3s}.checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked{background-color:#2196f3;border-color:#2196f3}.checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:after{content:"";position:absolute;top:2px;left:6px;width:4px;height:9px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #2196f34d}.input-tamanho[_ngcontent-%COMP%]{width:80px}.input-quantidade[_ngcontent-%COMP%]{width:100px}.input-search[_ngcontent-%COMP%]{flex:1;min-width:150px}.select-madeira[_ngcontent-%COMP%]{min-width:120px}.tamanho-separador[_ngcontent-%COMP%]{margin:0 5px}.input-autocomplete[_ngcontent-%COMP%]{background-color:#fff;color:#333;border:1px solid #ccc;width:100%;padding:10px;font-size:14px;border-radius:4px;box-sizing:border-box;outline:none;transition:border-color .2s,box-shadow .2s}.input-autocomplete[_ngcontent-%COMP%]:focus{border-color:#2196f3;box-shadow:0 0 0 3px #2196f333}.btn-adicionar[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%], .btn-add[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s}.btn-add[_ngcontent-%COMP%]{background-color:gray;color:#fff;width:100%}.btn-search[_ngcontent-%COMP%]{width:17.5%}.btn-adicionar[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-adicionar[_ngcontent-%COMP%]:hover, .btn-salvar[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-search[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff}.btn-search[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-editar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;margin:0 8px}.btn-editar[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-excluir[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;margin:0 8px}.btn-excluir[_ngcontent-%COMP%]:hover, .btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#da190b}.scrollable-table[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;margin-top:20px}.tabela-madeiras[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabela-madeiras[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333;width:20vw}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:999;padding:10px}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:20px;max-width:750px;width:100%;box-shadow:0 6px 20px #00000040;animation:_ngcontent-%COMP%_slideIn .3s ease-in-out;display:flex;flex-direction:column}.modal-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;text-align:center;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.modal-title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.modal-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;font-weight:700;color:#444}.modal_label_div[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;justify-content:center}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:10px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 1000px){.controle_container[_ngcontent-%COMP%]{flex-direction:column}.modal-content[_ngcontent-%COMP%]{max-width:98vw}.tabela-madeiras[_ngcontent-%COMP%]{min-width:400px}.painel-madeiras[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]{padding:10px}.form-madeira[_ngcontent-%COMP%], .form-search[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%], .tamanho-group[_ngcontent-%COMP%], .input-tamanho[_ngcontent-%COMP%], .input-quantidade[_ngcontent-%COMP%], .input-search[_ngcontent-%COMP%], .select-madeira[_ngcontent-%COMP%]{width:100%;min-width:unset}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-adicionar[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{width:100%;margin:5px 0}}']})};export{te as FerragensComponent};
