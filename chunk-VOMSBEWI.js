import{a as Z}from"./chunk-SE2NCUBX.js";import{a as X}from"./chunk-S3MWANP4.js";import{g as G,i as H,j as J,k as y,l as K,m as M,n as E,q as Q}from"./chunk-BBWGYPE6.js";import{b as B,c as N,d as z,e as R,f as q,g as U,l as $,n as Y}from"./chunk-RXS46TFZ.js";import"./chunk-WTIKVVTU.js";import{Da as s,Ha as A,Jb as j,Kb as L,Ma as T,Nb as D,Qa as w,Qb as v,R as I,W as x,Xa as P,Za as o,_a as i,ab as O,bb as h,c as k,cb as d,da as p,db as c,ea as f,eb as C,fb as W,hb as g,ib as u,jb as _,ua as V}from"./chunk-TPPPVHGH.js";import"./chunk-MKOOB2DY.js";import"./chunk-EZZN43H3.js";import{a as b,c as S,h as m}from"./chunk-2HP4JIPC.js";var F=class l{constructor(n,e,t,r){this.firestore=n;this.logsService=e;this.afAuth=t;this.platformId=r}getFerramentas(){if(!v(this.platformId))return new k(e=>e.complete());let n=y(this.firestore,"ferramentas");return H(n,{idField:"id"})}getFerramentaById(n){return m(this,null,function*(){if(!v(this.platformId))return;let e=M(this.firestore,`ferramentas/${n}`),t=yield E(e);if(t.exists())return b({id:t.id},t.data())})}checkAuth(){return m(this,null,function*(){return v(this.platformId)?(yield this.afAuth.currentUser)?!0:(console.warn("Usu\xE1rio n\xE3o autenticado - opera\xE7\xE3o bloqueada"),!1):!1})}addFerramenta(n){return m(this,null,function*(){if(!(yield this.checkAuth()))return Promise.reject("Usu\xE1rio n\xE3o autenticado ou ambiente inv\xE1lido");let e=y(this.firestore,"ferramentas"),t=(yield this.afAuth.currentUser)?.email??"desconhecido",r=this.logsService.logAction(`Adicionando Ferramenta: Nome: ${n.nome}, Especifica\xE7\xE3o: ${n.especificacao}, Respons\xE1vel: ${n.responsavel}`,t,"ADD");return this.logsService.addLog(r),J(e,n)})}deleteFerramenta(n){return m(this,null,function*(){if(!(yield this.checkAuth()))return Promise.reject("Usu\xE1rio n\xE3o autenticado ou ambiente inv\xE1lido");let e=M(this.firestore,`ferramentas/${n}`),r=(yield E(e)).data(),a=(yield this.afAuth.currentUser)?.email??"desconhecido";if(r){let te=this.logsService.logAction(`Removendo Ferramenta: Nome: ${r.nome}, Especifica\xE7\xE3o: ${r.especificacao}, Respons\xE1vel: ${r.responsavel}`,a,"REMOVE");this.logsService.addLog(te)}return K(e)})}updateFerramenta(n,e,t){return m(this,null,function*(){if(!(yield this.checkAuth()))return Promise.reject("Usu\xE1rio n\xE3o autenticado ou ambiente inv\xE1lido");if(!e)throw new Error("ferramentaAntiga is undefined");let r=(yield this.afAuth.currentUser)?.email??"desconhecido";this.logsService.addLog(this.logsService.logAction(`EDIT Ferramenta: ${e.nome}, Especifica\xE7\xE3o: ${e.especificacao}, Respons\xE1vel: ${e.responsavel} 
        Para -> Nome: ${t.nome}, Especifica\xE7\xE3o: ${t.especificacao}, Respons\xE1vel: ${t.responsavel}`,r,"EDIT"));let a=M(this.firestore,`ferramentas/${n}`);return Q(a,t)})}static \u0275fac=function(e){return new(e||l)(x(G),x(X),x(Z),x(V))};static \u0275prov=I({token:l,factory:l.\u0275fac,providedIn:"root"})};function ae(l,n){if(l&1){let e=O();o(0,"tr")(1,"td"),c(2),i(),o(3,"td"),c(4),i(),o(5,"td"),c(6),i(),o(7,"td")(8,"button",13),h("click",function(){let r=p(e).$implicit,a=d();return f(a.editar(r))}),c(9,"Editar"),i(),o(10,"button",14),h("click",function(){let r=p(e).$implicit,a=d();return f(a.excluir(r.id))}),c(11,"Excluir"),i()()()}if(l&2){let e=n.$implicit;s(2),C(e.nome),s(2),C(e.especificacao),s(2),C(e.responsavel)}}function oe(l,n){if(l&1){let e=O();o(0,"div",15)(1,"div",16)(2,"h3",17),c(3,"Editar Ferramenta"),i(),o(4,"label",18)(5,"input",19),_("ngModelChange",function(r){p(e);let a=d();return u(a.ferramentaEditando.nome,r)||(a.ferramentaEditando.nome=r),f(r)}),i()(),o(6,"label",18)(7,"input",20),_("ngModelChange",function(r){p(e);let a=d();return u(a.ferramentaEditando.especificacao,r)||(a.ferramentaEditando.especificacao=r),f(r)}),i()(),o(8,"label",18)(9,"input",21),_("ngModelChange",function(r){p(e);let a=d();return u(a.ferramentaEditando.responsavel,r)||(a.ferramentaEditando.responsavel=r),f(r)}),i()(),o(10,"div",22)(11,"button",23),h("click",function(){p(e);let r=d();return f(r.salvarEdicao())}),c(12,"Salvar"),i(),o(13,"button",24),h("click",function(){p(e);let r=d();return f(r.cancelarEdicao())}),c(14,"Cancelar"),i()()()()}if(l&2){let e=d();s(5),g("ngModel",e.ferramentaEditando.nome),s(2),g("ngModel",e.ferramentaEditando.especificacao),s(2),g("ngModel",e.ferramentaEditando.responsavel)}}var ee=class l{constructor(n){this.ferramentaService=n}ferramentas=[];novaFerramenta=this.criarFerramentaVazia();ferramentaEditando=this.criarFerramentaVazia();editando=!1;catalogoFerramentas=[];termoBusca="";ngOnInit(){this.ferramentaService.getFerramentas().subscribe(n=>{this.catalogoFerramentas=n.map(e=>e.nome)}),this.carregarFerramentas()}adicionar(){this.validaFerramenta(this.novaFerramenta)?this.ferramentaService.addFerramenta(this.novaFerramenta).then(()=>{this.novaFerramenta=this.criarFerramentaVazia()}):alert("Ferramenta n\xE3o adicionada. Verifique os campos.")}editar(n){this.ferramentaEditando=b({},n),this.editando=!0}salvarEdicao(){return m(this,null,function*(){let n=yield this.ferramentaService.getFerramentaById(String(this.ferramentaEditando.id));if(this.ferramentaEditando.id){let e=this.ferramentaEditando,{id:t}=e,r=S(e,["id"]);this.ferramentaService.updateFerramenta(t,n,r).then(()=>{this.editando=!1})}})}cancelarEdicao(){this.editando=!1}excluir(n){confirm("Tem certeza que deseja excluir esta ferramenta?")&&this.ferramentaService.deleteFerramenta(n)}buscarFerramenta(){let n=this.termoBusca.trim().toLowerCase();if(n==="")this.carregarFerramentas();else{let e=this.ferramentas.filter(t=>t.nome.toLowerCase().includes(n));e.length===0?this.carregarFerramentas():this.ferramentas=e}}carregarFerramentas(){this.ferramentaService.getFerramentas().subscribe(n=>this.ferramentas=n)}criarFerramentaVazia(){return{nome:"",especificacao:"",responsavel:""}}validaFerramenta(n){return!n.nome||!n.especificacao||!n.responsavel?(alert("Todos os campos s\xE3o obrigat\xF3rios."),!1):!0}static \u0275fac=function(e){return new(e||l)(A(F))};static \u0275cmp=T({type:l,selectors:[["app-ferramentas"]],decls:28,vars:7,consts:[[1,"controle"],[1,"controle_title"],[1,"controle_container",3,"ngSubmit"],["name","nomeFerramenta","type","text","placeholder","Nome da ferramenta","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["name","especificacao","type","text","placeholder","Especifica\xE7\xE3o","required","",1,"controle_container_input",2,"flex","2",3,"ngModelChange","ngModel"],["name","responsavel","type","text","placeholder","Funcion\xE1rio ou Local","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["type","submit",1,"btn-adicionar"],[1,"controle_container"],["type","text","placeholder","Buscar Ferramenta",1,"controle_container_input",3,"ngModelChange","input","ngModel"],[1,"scrollable-table"],[1,"tabela-ferramentas"],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"btn-editar",3,"click"],[1,"btn-excluir",3,"click"],[1,"modal"],[1,"modal-content"],[1,"modal-title"],[1,"modal-label"],["name","nome","type","text","placeholder","Nome da ferramenta","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["name","especificacao","type","text","placeholder","Especifica\xE7\xE3o","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["name","responsavel","type","text","placeholder","Funcion\xE1rio ou Local","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn-salvar",3,"click"],[1,"btn-cancelar",3,"click"]],template:function(e,t){e&1&&(o(0,"section",0)(1,"h2",1),c(2,"Controle de Ferramentas"),i(),o(3,"form",2),h("ngSubmit",function(){return t.adicionar()}),o(4,"input",3),_("ngModelChange",function(a){return u(t.novaFerramenta.nome,a)||(t.novaFerramenta.nome=a),a}),i(),o(5,"input",4),_("ngModelChange",function(a){return u(t.novaFerramenta.especificacao,a)||(t.novaFerramenta.especificacao=a),a}),i(),o(6,"input",5),_("ngModelChange",function(a){return u(t.novaFerramenta.responsavel,a)||(t.novaFerramenta.responsavel=a),a}),i(),o(7,"button",6),c(8,"Adicionar"),i()(),o(9,"div",7)(10,"input",8),_("ngModelChange",function(a){return u(t.termoBusca,a)||(t.termoBusca=a),a}),h("input",function(){return t.buscarFerramenta()}),i()(),o(11,"div",9)(12,"table",10)(13,"thead")(14,"tr")(15,"th"),c(16,"Nome"),i(),o(17,"th"),c(18,"Especifica\xE7\xE3o"),i(),o(19,"th"),c(20,"Respons\xE1vel"),i(),o(21,"th"),c(22,"A\xE7\xF5es"),i()()(),o(23,"tbody"),w(24,ae,12,3,"tr",11),i()()(),o(25,"p"),c(26),i()(),w(27,oe,15,3,"div",12)),e&2&&(s(4),g("ngModel",t.novaFerramenta.nome),s(),g("ngModel",t.novaFerramenta.especificacao),s(),g("ngModel",t.novaFerramenta.responsavel),s(4),g("ngModel",t.termoBusca),s(14),P("ngForOf",t.ferramentas),s(2),W("Itens Cadastrados ",t.ferramentas.length,""),s(),P("ngIf",t.editando))},dependencies:[D,j,L,Y,U,B,N,z,$,q,R],styles:['.controle[_ngcontent-%COMP%]{background-color:#f9f9f9;margin:20px;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;display:flex;align-items:center;flex-direction:column;justify-content:center}.controle_title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.controle_title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.controle_container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;flex-direction:row;width:100%;gap:10px;margin-bottom:20px}.controle_container_input[_ngcontent-%COMP%]{background-color:#fff;color:#333;border:1px solid #ccc;width:100%;padding:10px;font-size:14px;border-radius:4px;appearance:none;box-sizing:border-box;outline:none;transition:border-color .2s}.controle_container_input[_ngcontent-%COMP%]:focus{border-color:#2196f3}.controle_container_input[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#222}.form-search[_ngcontent-%COMP%], .form-ferramenta[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;gap:10px;margin-bottom:10px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;min-width:150px}.input-search[_ngcontent-%COMP%]{flex:1;min-width:150px;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px}.select-ferramenta[_ngcontent-%COMP%]{min-width:120px}.btn-adicionar[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s}.btn-adicionar[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-adicionar[_ngcontent-%COMP%]:hover, .btn-salvar[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-search[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff}.btn-search[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-editar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;margin:0 8px}.btn-editar[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-excluir[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;margin:0 8px}.btn-excluir[_ngcontent-%COMP%]:hover, .btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#da190b}.scrollable-table[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;margin-top:20px}.tabela-ferramentas[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}.tabela-ferramentas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabela-ferramentas[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.tabela-ferramentas[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333;width:20vw}.tabela-ferramentas[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.tabela-ferramentas[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:999;padding:10px}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:20px;max-width:750px;width:100%;box-shadow:0 6px 20px #00000040;animation:_ngcontent-%COMP%_slideIn .3s ease-in-out;display:flex;flex-direction:column}.modal-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;text-align:center;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.modal-title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.modal-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;font-weight:700;color:#444}.modal_label_div[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;justify-content:center}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:10px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 1000px){.controle_container[_ngcontent-%COMP%]{flex-direction:column}.modal-content[_ngcontent-%COMP%]{max-width:98vw;padding:10px}.tabela-ferramentas[_ngcontent-%COMP%]{min-width:400px}.form-ferramenta[_ngcontent-%COMP%], .form-search[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%], .input-search[_ngcontent-%COMP%], .select-ferramenta[_ngcontent-%COMP%]{width:100%;min-width:unset}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-adicionar[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{width:100%;margin:5px 0}}']})};export{ee as FerramentasComponent};
