import{a as te}from"./chunk-MHGOT2T3.js";import{f as K,h as X,i as Y,j as P,k as Z,l as v,m as S,p as ee}from"./chunk-2UIDV6SX.js";import{b as B,c as D,d as L,e as Q,f as j,g as $,h as U,j as R,k as G,l as H,n as J}from"./chunk-LIY3GWMI.js";import{D as A}from"./chunk-EUBCM5F7.js";import{$ as M,$a as y,Ia as d,Ma as V,Qb as T,Ra as N,Rb as W,Ub as z,Va as C,W as q,a as x,ab as b,c as k,cb as i,db as o,eb as E,fb as O,g as h,gb as _,hb as s,ia as g,ib as c,ja as m,jb as F,kb as I,mb as p,nb as f,ob as u}from"./chunk-VQDQLYRV.js";var w=class l{constructor(t,e,n){this.firestore=t;this.logsService=e;this.auth=n}getFerragens(){let t=P(this.firestore,"ferragens");return X(t,{idField:"id"})}getFerragemById(t){return h(this,null,function*(){let e=v(this.firestore,`ferragens/${t}`),n=yield S(e);if(n.exists())return x({id:n.id},n.data())})}addFerragem(t){let e=P(this.firestore,"ferragens"),n=this.logsService.logAction(`Adicionando Ferragem: Nome: ${t.nome}, Especifica\xE7\xE3o: ${t.especificacao}, Quantidade: ${t.quantidade}`,`${this.auth.currentUser?.email}`,"ADD");return this.logsService.addLog(n),Y(e,t)}deleteFerragem(t){return h(this,null,function*(){let e=v(this.firestore,`ferragens/${t}`),r=(yield S(e)).data();if(r){let a=this.logsService.logAction(`Removendo Ferragem: Nome: ${r.nome}, Especifica\xE7\xE3o: ${r.especificacao}, Quantidade: ${r.quantidade}`,`${this.auth.currentUser?.email}`,"REMOVE");this.logsService.addLog(a)}return Z(e)})}updateFerragem(t,e,n){let r=v(this.firestore,`ferragens/${t}`);if(!e)throw new Error("ferragemAntiga is undefined");return this.logsService.addLog(this.logsService.logAction(`EDIT Ferragem: ${e.nome}, Especifica\xE7\xE3o: ${e.especificacao}, Quantidade: ${e.quantidade} 
        Para -> Nome: ${n.nome}, Especifica\xE7\xE3o: ${n.especificacao}, Quantidade: ${n.quantidade}`,`${this.auth.currentUser?.email}`,"EDIT")),ee(r,n)}static \u0275fac=function(e){return new(e||l)(M(K),M(te),M(A))};static \u0275prov=q({token:l,factory:l.\u0275fac,providedIn:"root"})};function ie(l,t){if(l&1&&E(0,"option",17),l&2){let e=t.$implicit;b("value",e)}}function oe(l,t){if(l&1&&E(0,"option",17),l&2){let e=t.$implicit;b("value",e)}}function ce(l,t){if(l&1){let e=O();i(0,"tr")(1,"td"),c(2),o(),i(3,"td"),c(4),o(),i(5,"td"),c(6),o(),i(7,"td")(8,"button",18),_("click",function(){let r=g(e).$implicit,a=s();return m(a.editar(r))}),c(9,"Editar"),o(),i(10,"button",19),_("click",function(){let r=g(e).$implicit,a=s();return m(a.excluir(r.id))}),c(11,"Excluir"),o()()()}if(l&2){let e=t.$implicit;d(2),F(e.nome),d(2),F(e.especificacao),d(2),F(e.quantidade)}}function le(l,t){if(l&1){let e=O();i(0,"div",20)(1,"div",21)(2,"h3",22),c(3,"Editar Ferragem"),o(),i(4,"label",23)(5,"p",24),c(6,"Nome: "),o(),i(7,"input",25),u("ngModelChange",function(r){g(e);let a=s();return f(a.ferragemEditando.nome,r)||(a.ferragemEditando.nome=r),m(r)}),o()(),i(8,"label",23)(9,"p",24),c(10,"Especifica\xE7\xE3o: "),o(),i(11,"input",26),u("ngModelChange",function(r){g(e);let a=s();return f(a.ferragemEditando.especificacao,r)||(a.ferragemEditando.especificacao=r),m(r)}),o()(),i(12,"label",23)(13,"p",24),c(14,"Quantidade: "),o(),i(15,"input",27),u("ngModelChange",function(r){g(e);let a=s();return f(a.ferragemEditando.quantidade,r)||(a.ferragemEditando.quantidade=r),m(r)}),o()(),i(16,"div",28)(17,"button",29),_("click",function(){g(e);let r=s();return m(r.salvarEdicao())}),c(18,"Salvar"),o(),i(19,"button",30),_("click",function(){g(e);let r=s();return m(r.cancelarEdicao())}),c(20,"Cancelar"),o()()()()}if(l&2){let e=s();d(7),p("ngModel",e.ferragemEditando.nome),d(4),p("ngModel",e.ferragemEditando.especificacao),d(4),p("ngModel",e.ferragemEditando.quantidade)}}var ne=class l{constructor(t){this.ferragemService=t}ferragens=[];novaFerragem=this.criarFerragemVazia();ferragemEditando=this.criarFerragemVazia();editando=!1;catalogoFerragens=[];catalogoEspecificacoes=[];termoBusca="";ngOnInit(){this.carregarFerragens()}adicionar(){if(!this.validaNome(this.novaFerragem.nome)||!this.validaQuantidade(this.novaFerragem.quantidade))return;let t=x({},this.novaFerragem);this.verificaExistente(t)?this.atualizarQuantidadeExistente(t):this.ferragemService.addFerragem(t).then(()=>{this.novaFerragem=this.criarFerragemVazia()})}editar(t){this.ferragemEditando=x({},t),this.editando=!0}cancelarEdicao(){this.editando=!1}salvarEdicao(){return h(this,null,function*(){if(!this.ferragemEditando.id)return;let r=this.ferragemEditando,{id:t}=r,e=k(r,["id"]),n=yield this.ferragemService.getFerragemById(t);this.ferragemService.updateFerragem(t,n,e).then(()=>{this.editando=!1})})}excluir(t){confirm("Tem certeza que deseja excluir esta ferragem?")&&this.ferragemService.deleteFerragem(t)}buscarFerragem(){let t=this.termoBusca.trim().toLowerCase();if(t==="")this.carregarFerragens(),console.log(this.ferragens.length);else{let e=this.ferragens.filter(n=>n.nome.toLowerCase().includes(t));e.length===0&&e.length!=this.ferragens.length?this.carregarFerragens():this.ferragens=e}}carregarFerragens(){this.ferragemService.getFerragens().subscribe(t=>{this.ferragens=t;let e=new Set(t.map(r=>r.nome));this.catalogoFerragens=Array.from(e);let n=new Set(t.map(r=>r.especificacao));this.catalogoEspecificacoes=Array.from(n)})}criarFerragemVazia(){return{nome:"",especificacao:"",quantidade:0}}atualizarQuantidadeExistente(t){this.ferragens.forEach(e=>h(this,null,function*(){if(e.nome===t.nome&&e.especificacao===t.especificacao){let n=yield this.ferragemService.getFerragemById(e.id);this.ferragemService.updateFerragem(e.id,n,{quantidade:Number(e.quantidade)+Number(t.quantidade)})}}))}validaNome(t){return!0}validaQuantidade(t){return Number(t)>0?!0:(alert("Quantidade deve ser maior que 0!"),!1)}verificaExistente(t){return this.ferragens.some(e=>e.nome===t.nome&&e.especificacao===t.especificacao)}static \u0275fac=function(e){return new(e||l)(V(w))};static \u0275cmp=N({type:l,selectors:[["app-ferragens"]],decls:33,vars:11,consts:[[1,"controle"],[1,"title"],[1,"form-wrap",3,"ngSubmit"],["name","nome","type","text","placeholder","Nome da Ferragem","required","",1,"input",3,"ngModelChange","ngModel"],["id","catalogoFerragens_list"],[3,"value",4,"ngFor","ngForOf"],["name","especificacao","type","text","placeholder","Especifica\xE7\xE3o","required","",1,"input",3,"ngModelChange","ngModel"],["id","catalogoEspecificacoes_list"],["name","quantidade","type","number","placeholder","Quantidade","required","",1,"input",3,"ngModelChange","ngModel"],["type","submit",1,"btn"],[1,"form-toggle"],["type","text","placeholder","Buscar Ferragem",1,"input-search",3,"ngModelChange","input","ngModel"],[1,"scrollable-table"],[1,"scrollable-table-tabela"],[1,"tabela"],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[3,"value"],[1,"btn-sm","edit",3,"click"],[1,"btn-sm","delete",3,"click"],[1,"modal"],[1,"modal-content"],[1,"modal-title"],[1,"modal-label"],[1,"modal-label-text"],["type","text","name","nome","placeholder","Nome da Ferragem","required","",1,"input","modal-label-input",3,"ngModelChange","ngModel"],["type","text","name","especificacao","placeholder","Especifica\xE7\xE3o","required","",1,"input","modal-label-input",3,"ngModelChange","ngModel"],["type","number","name","quantidade","placeholder","Quantidade","required","",1,"input","modal-label-input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(e,n){e&1&&(i(0,"section",0)(1,"h2",1),c(2,"Controle de Ferragens"),o(),i(3,"form",2),_("ngSubmit",function(){return n.adicionar()}),i(4,"input",3),u("ngModelChange",function(a){return f(n.novaFerragem.nome,a)||(n.novaFerragem.nome=a),a}),o(),i(5,"datalist",4),C(6,ie,1,1,"option",5),o(),i(7,"input",6),u("ngModelChange",function(a){return f(n.novaFerragem.especificacao,a)||(n.novaFerragem.especificacao=a),a}),o(),i(8,"datalist",7),C(9,oe,1,1,"option",5),o(),i(10,"input",8),u("ngModelChange",function(a){return f(n.novaFerragem.quantidade,a)||(n.novaFerragem.quantidade=a),a}),o(),i(11,"button",9),c(12,"Adicionar"),o()(),i(13,"div",10)(14,"input",11),u("ngModelChange",function(a){return f(n.termoBusca,a)||(n.termoBusca=a),a}),_("input",function(){return n.buscarFerragem()}),o()(),i(15,"div",12)(16,"div",13)(17,"table",14)(18,"thead")(19,"tr")(20,"th"),c(21,"Nome"),o(),i(22,"th"),c(23,"Especifica\xE7\xE3o"),o(),i(24,"th"),c(25,"Quantidade"),o(),i(26,"th"),c(27,"A\xE7\xF5es"),o()()(),i(28,"tbody"),C(29,ce,12,3,"tr",15),o()()()(),i(30,"p"),c(31),o(),C(32,le,21,3,"div",16),o()),e&2&&(d(4),p("ngModel",n.novaFerragem.nome),y("list","catalogoFerragens_list"),d(2),b("ngForOf",n.catalogoFerragens),d(),p("ngModel",n.novaFerragem.especificacao),y("list","catalogoEspecificacoes_list"),d(2),b("ngForOf",n.catalogoEspecificacoes),d(),p("ngModel",n.novaFerragem.quantidade),d(4),p("ngModel",n.termoBusca),d(15),b("ngForOf",n.ferragens),d(2),I("Itens Cadastrados ",n.ferragens.length,""),d(),b("ngIf",n.editando))},dependencies:[z,T,W,J,$,R,G,B,U,D,L,H,j,Q],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f8f9fa;color:#333;padding:1rem}.controle[_ngcontent-%COMP%]{margin:auto;padding:1rem;padding-left:120px}.title[_ngcontent-%COMP%]{font-size:3rem;font-weight:700;color:#2c3e50;text-align:center;margin:2rem 0 1.5rem;position:relative;text-transform:uppercase}.title[_ngcontent-%COMP%]:after{content:"";display:block;width:35vw;height:4px;background-color:#4f46e5;margin:.5rem auto 0;border-radius:2px}.form-toggle[_ngcontent-%COMP%]{margin-bottom:1rem;padding:1rem;background-color:#fff;border-radius:8px;box-shadow:0 2px 8px #0000000d;display:flex;justify-content:center;flex-direction:column}.form-wrap[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem;background-color:#fff;padding:1rem;border-radius:8px;box-shadow:0 2px 8px #0000000d}.no-shadow[_ngcontent-%COMP%]{box-shadow:none;padding:.5rem 0}.input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{flex:1 1 200px;padding:.7rem;border:1px solid #ccc;border-radius:6px;font-size:1rem;background-color:#fefefe}.input-search[_ngcontent-%COMP%]{padding:.7rem;border:1px solid #ccc;border-radius:6px;font-size:1rem;background-color:#fefefe}.tamanho[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;flex:1 1 100%}.checkboxes[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;align-items:center}.checkboxes[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem}.btn[_ngcontent-%COMP%], .btn-sm[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-disabled[_ngcontent-%COMP%]{padding:.6rem 1.2rem;font-size:1rem;border-radius:6px;border:none;cursor:pointer;transition:.2s ease-in-out}.btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.btn[_ngcontent-%COMP%]:hover{background-color:#218838}.btn-sm.edit[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;margin-right:.5rem}.btn-sm.delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]:hover{opacity:.9}.btn-secondary[_ngcontent-%COMP%]{background-color:#352bec;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#4f46e5}.btn-disabled[_ngcontent-%COMP%]{background-color:#ccc;color:#666;cursor:not-allowed}.scrollable-table[_ngcontent-%COMP%]{background-color:#fff;padding:1rem;border-radius:8px;box-shadow:0 2px 8px #0000000d;margin-bottom:1rem}.tabela[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px;font-family:Arial,Helvetica,sans-serif;border-radius:8px;overflow:hidden;box-shadow:0 4px 10px #0000000d}.scrollable-table-tabela[_ngcontent-%COMP%]{width:100%;max-height:56vh;overflow-y:auto;display:block;border:1px solid #dee2e6;border-radius:8px}.scrollable-table-tabela[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.scrollable-table-tabela[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.scrollable-table-tabela[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#adb5bd;border-radius:10px;border:2px solid #f1f1f1}.scrollable-table-tabela[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#868e96}.scrollable-table-tabela[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:#adb5bd #f1f1f1}.tabela[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f1f3f5;z-index:1;text-transform:uppercase;font-weight:600;transition:background-color .3s;box-shadow:0 2px 3px #00000008}.tabela[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabela[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border-bottom:1px solid #dee2e6;text-align:center;transition:background-color .2s ease,color .2s ease}.tabela[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;cursor:pointer}.tabela[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover{background-color:#e9f5ff;color:#007bff}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;justify-content:center;align-items:center;z-index:999}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:2rem;width:90%;max-width:600px;box-shadow:0 4px 20px #0003;overflow-y:auto;max-height:90vh}.modal-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:1rem 0}.modal-label-text[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;text-transform:uppercase;font-weight:700}.modal-label-input[_ngcontent-%COMP%]{max-width:400px;width:100%}.modal-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#2c3e50;text-align:center;margin:2rem 0 1.5rem;position:relative;text-transform:uppercase}.modal-title[_ngcontent-%COMP%]:after{content:"";display:block;width:60%;height:4px;background-color:#4f46e5;margin:.5rem auto 0;border-radius:2px}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1.5rem}.flex-1[_ngcontent-%COMP%]{flex:1 1 100%}@media (max-width: 768px){.form-wrap[_ngcontent-%COMP%], .tamanho[_ngcontent-%COMP%], .checkboxes[_ngcontent-%COMP%], .modal-actions[_ngcontent-%COMP%], .form-toggle[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%}.btn-sm[_ngcontent-%COMP%]{width:100%;margin-bottom:.5rem}.tabela[_ngcontent-%COMP%]{font-size:.9rem}}']})};export{ne as FerragensComponent};
