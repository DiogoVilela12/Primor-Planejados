import{b as y,d as w,e as O,f as P,g as D,h as v,i as F,j as te}from"./chunk-LX7ODXZP.js";import{a as A,b as $,c as Q,d as G,e as U,f as H,g as X,h as Y,i as Z,j as J,k as K,l as ee}from"./chunk-LLHPTXWT.js";import{D as R}from"./chunk-5W7NWR7I.js";import{$ as x,Ia as l,Ma as I,Mb as B,Nb as z,Ob as j,Ra as V,Va as h,W as S,a as E,ab as u,b as q,c as L,cb as o,db as r,fb as W,g as b,gb as f,hb as g,ia as M,ib as s,ja as _,jb as C,lb as N,mb as c,nb as m,ob as p}from"./chunk-QKIDFHIK.js";var k=class d{constructor(t){this.firestore=t}logAction(t,e,n){return{action:t,userId:e,timestamp:new Date,details:n}}getLogs(){let t=P(this.firestore,"logs");return w(t,{idField:"id"})}addLog(t){let e=P(this.firestore,"logs");return O(e,t)}deleteLog(t){let e=v(this.firestore,`logs/${t}`);return D(e)}static \u0275fac=function(e){return new(e||d)(x(y))};static \u0275prov=S({token:d,factory:d.\u0275fac,providedIn:"root"})};var T=class d{constructor(t,e,n){this.firestore=t;this.logsService=e;this.auth=n}getMadeiras(){let t=P(this.firestore,"madeiras");return w(t,{idField:"id"})}getMadeiraById(t){return b(this,null,function*(){let e=v(this.firestore,`madeiras/${t}`),n=yield F(e);if(n.exists())return E({id:n.id},n.data())})}addMadeira(t){let e=P(this.firestore,"madeiras"),n=this.logsService.logAction(`Adicionando Nome: ${t.nome} 
            Tamanho: ${t.tamanho.comprimento} x ${t.tamanho.espessura} x ${t.tamanho.largura}, 
            Quantidade ${t.quantidade}`,`${this.auth.currentUser?.email}`,"ADD");return this.logsService.addLog(n),O(e,t)}deleteMadeira(t){return b(this,null,function*(){let e=v(this.firestore,`madeiras/${t}`),a=(yield F(e)).data();if(a){let i=this.logsService.logAction(`
                Removendo Nome: ${a.nome} 
                Tamanho: ${a.tamanho.comprimento} x ${a.tamanho.espessura} x ${a.tamanho.largura}, 
                Quantidade ${a.quantidade}`,`${this.auth.currentUser?.email}`,"REMOVE");this.logsService.addLog(i)}return D(e)})}updateMadeira(t,e,n){let a=v(this.firestore,`madeiras/${t}`);if(!e)throw new Error("madeiraAntiga is undefined");return this.logsService.addLog(this.logsService.logAction(`EDIT Madeira ${e.nome}
                Tamanho ${e.tamanho?.comprimento} x 
                ${e.tamanho?.espessura} x 
                ${e.tamanho?.largura}, Quantidade ${e.quantidade}

                Para -> Madeira ${n.nome} 
                Tamanho ${n.tamanho?.comprimento} x 
                ${n.tamanho?.espessura} x 
                ${n.tamanho?.largura}, Quantidade ${n.quantidade}`,`${this.auth.currentUser?.email}`,"EDIT")),te(a,n)}static \u0275fac=function(e){return new(e||d)(x(y),x(k),x(R))};static \u0275prov=S({token:d,factory:d.\u0275fac,providedIn:"root"})};function de(d,t){if(d&1&&(o(0,"option",20),s(1),r()),d&2){let e=t.$implicit;u("value",e),l(),C(e)}}function se(d,t){if(d&1&&(o(0,"option",20),s(1),r()),d&2){let e=t.$implicit;u("value",e),l(),C(e)}}function le(d,t){if(d&1){let e=W();o(0,"tr")(1,"td"),s(2),r(),o(3,"td"),s(4),r(),o(5,"td"),s(6),r(),o(7,"td")(8,"button",21),f("click",function(){let a=M(e).$implicit,i=g();return _(i.editar(a))}),s(9,"Editar"),r(),o(10,"button",22),f("click",function(){let a=M(e).$implicit,i=g();return _(i.excluir(a.id))}),s(11,"Excluir"),r()()()}if(d&2){let e=t.$implicit;l(2),C(e.nome),l(2),N("",e.tamanho.largura," x ",e.tamanho.espessura," x ",e.tamanho.comprimento,""),l(2),C(e.quantidade)}}function ce(d,t){if(d&1&&(o(0,"option",20),s(1),r()),d&2){let e=t.$implicit;u("value",e),l(),C(e)}}function me(d,t){if(d&1&&(o(0,"option",20),s(1),r()),d&2){let e=t.$implicit;u("value",e),l(),C(e)}}function pe(d,t){if(d&1){let e=W();o(0,"div",23)(1,"div",24)(2,"h3",25),s(3,"Editar Madeira"),r(),o(4,"label",26)(5,"select",27),p("ngModelChange",function(a){M(e);let i=g();return m(i.madeiraEditando.nome,a)||(i.madeiraEditando.nome=a),_(a)}),o(6,"option",4),s(7,"Cor da madeira"),r(),h(8,ce,2,2,"option",5),r()(),o(9,"label",26)(10,"div",28)(11,"input",7),p("ngModelChange",function(a){M(e);let i=g();return m(i.madeiraEditando.tamanho.largura,a)||(i.madeiraEditando.tamanho.largura=a),_(a)}),r(),o(12,"p",29),s(13,"x"),r(),o(14,"select",27),p("ngModelChange",function(a){M(e);let i=g();return m(i.madeiraEditando.tamanho.espessura,a)||(i.madeiraEditando.tamanho.espessura=a),_(a)}),o(15,"option",4),s(16,"Espessura"),r(),h(17,me,2,2,"option",5),r(),o(18,"p",29),s(19,"x"),r(),o(20,"input",30),p("ngModelChange",function(a){M(e);let i=g();return m(i.madeiraEditando.tamanho.comprimento,a)||(i.madeiraEditando.tamanho.comprimento=a),_(a)}),r()()(),o(21,"label",26)(22,"input",31),p("ngModelChange",function(a){M(e);let i=g();return m(i.madeiraEditando.quantidade,a)||(i.madeiraEditando.quantidade=a),_(a)}),r()(),o(23,"div",32)(24,"button",33),f("click",function(){M(e);let a=g();return _(a.salvarEdicao())}),s(25,"Salvar"),r(),o(26,"button",34),f("click",function(){M(e);let a=g();return _(a.cancelarEdicao())}),s(27,"Cancelar"),r()()()()}if(d&2){let e=g();l(5),c("ngModel",e.madeiraEditando.nome),l(3),u("ngForOf",e.catalogoMDF_MDP),l(3),c("ngModel",e.madeiraEditando.tamanho.largura),l(3),c("ngModel",e.madeiraEditando.tamanho.espessura),l(3),u("ngForOf",e.espessurasMDF_MDP),l(3),c("ngModel",e.madeiraEditando.tamanho.comprimento),l(2),c("ngModel",e.madeiraEditando.quantidade)}}var ae=class d{constructor(t){this.madeiraService=t}madeiras=[];novaMadeira=this.criarMadeiraVazia();madeiraEditando=this.criarMadeiraVazia();madeiraSelecionada="";editarando=!1;catalogoMDF_MDP=["MDP Branco TX","MDP Blues ES","MDP Boho ES","MDP Camurca ES","MDP Cinza ES","MDP Country EW","MDP Cristal ES","MDP Eucalipto ES","MDP Folk EW","MDP Grecia ES","MDP Hard Rock ES","MDP Moscata GR","MDP Nude ES","MDP Off ES","MDP Preto TC","MDP Roots GR","MDP Zen ES","MDP Carvalho Nord ES","MDP Carvalho Campestre ES","MDP Oasis ES","MDP Carvalho Mel ES"];espessurasMDF_MDP=[6,15,18,20,25,30];ngOnInit(){this.carregarMadeiras()}adicionar(){this.novaMadeira={nome:this.novaMadeira.nome,tamanho:this.novaMadeira.tamanho,quantidade:this.novaMadeira.quantidade},this.validaNome(this.novaMadeira.nome)&&this.validaQuantidade(this.novaMadeira.quantidade)&&this.validaTamanho(this.novaMadeira.tamanho)?this.verificaPeca(this.novaMadeira)?this.atualizarQuantidadeExistente(this.novaMadeira):this.madeiraService.addMadeira(this.novaMadeira).then(()=>{this.novaMadeira=this.criarMadeiraVazia()}):alert("Madeira n\xE3o adicionada, tente novamente!")}excluir(t){confirm("Tem certeza que deseja excluir esta madeira?")&&this.madeiras.find(n=>n.id===t)&&this.madeiraService.deleteMadeira(t)}editar(t){this.madeiraEditando=E({},t),this.editarando=!0}salvarEdicao(){return b(this,null,function*(){let t=yield this.madeiraService.getMadeiraById(String(this.madeiraEditando.id));if(this.madeiraEditando.id){let e=this.madeiraEditando,{id:n}=e,a=L(e,["id"]),i=q(E({},a),{nome:a.nome,tamanho:a.tamanho,quantidade:a.quantidade});this.madeiraService.updateMadeira(n,t,i).then(()=>{this.editarando=!1})}})}cancelarEdicao(){this.editarando=!1}carregarMadeiras(){this.madeiraService.getMadeiras().subscribe(t=>this.madeiras=t)}criarMadeiraVazia(){return{nome:"",tamanho:{espessura:"",comprimento:"",largura:""},quantidade:""}}atualizarQuantidadeExistente(t){this.madeiras.forEach(e=>b(this,null,function*(){let n=this.madeiraService.getMadeiraById(e.id);e.nome===t.nome&&e.tamanho.comprimento===t.tamanho.comprimento&&e.tamanho.espessura===t.tamanho.espessura&&e.tamanho.largura===t.tamanho.largura&&this.madeiraService.updateMadeira(e.id,yield n,{quantidade:Number(e.quantidade)+Number(t.quantidade)})}))}validaNome(t){return this.catalogoMDF_MDP.includes(t)?!0:(alert("Nome Invalido"),!1)}validaQuantidade(t){return Number(t)>0?!0:(alert("Quantidade Menor ou igual a 0"),!1)}validaTamanho(t){let e=[6,15,18,20,25,30],n=Number(t.comprimento),a=Number(t.largura),i=Number(t.espessura);return n>0&&n<2700&&a>0&&a<2700&&e.includes(i)?!0:(alert("Tamanho inv\xE1lido! Comprimento e largura devem ser entre 1 e 2699, e espessura deve ser uma das: "+e.join(", ")),!1)}verificaPeca(t){return this.madeiras.some(e=>e.nome===t.nome&&e.tamanho.comprimento===t.tamanho.comprimento&&e.tamanho.espessura===t.tamanho.espessura&&e.tamanho.largura===t.tamanho.largura)}termoBusca="";buscarMadeira(){let t=this.termoBusca.trim().toLowerCase();if(t==="")this.carregarMadeiras();else{let e=this.madeiras.filter(n=>n.nome.toLowerCase().includes(t));this.madeiras=e}}static \u0275fac=function(e){return new(e||d)(I(T))};static \u0275cmp=V({type:d,selectors:[["app-madeiras"]],decls:38,vars:10,consts:[[1,"controle"],[1,"controle_title"],[1,"controle_container",3,"ngSubmit"],["name","madeira","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[1,"controle_container_tamanho",2,"flex","1"],["type","number","name","Comprimento","placeholder","Comprimento","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["name","espessura","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["value","","disabled","","selected","","hidden","",1,"controle_container_input_option"],["name","largura","type","number","placeholder","Largura","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["name","quantidade","type","number","placeholder","Quantidade de Pe\xE7as","required","",1,"controle_container_input",2,"flex","1",3,"ngModelChange","ngModel"],["type","submit",1,"btn-adicionar"],["action","Seach",1,"controle_container"],["type","text","placeholder","Buscar Madeira",1,"controle_container_input",3,"ngModelChange","input","ngModel"],["type","submit","disabled","",1,"btn-add"],[1,"scrollable-table"],[1,"tabela-madeiras"],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[3,"value"],[1,"btn-editar",3,"click"],[1,"btn-excluir",3,"click"],[1,"modal"],[1,"modal-content"],[1,"modal-title"],[1,"modal-label"],["id","madeira","name","madeira","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],[1,"modal_label_div"],[1,"tamanho-separador"],["type","number","name","Largura","placeholder","Largura","required","",1,"controle_container_input",3,"ngModelChange","ngModel"],["type","number",1,"controle_container_input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn-salvar",3,"click"],[1,"btn-cancelar",3,"click"]],template:function(e,n){e&1&&(o(0,"section",0)(1,"h2",1),s(2,"Controle de Madeiras"),r(),o(3,"form",2),f("ngSubmit",function(){return n.adicionar()}),o(4,"select",3),p("ngModelChange",function(i){return m(n.novaMadeira.nome,i)||(n.novaMadeira.nome=i),i}),o(5,"option",4),s(6,"Cor da madeira"),r(),h(7,de,2,2,"option",5),r(),o(8,"div",6)(9,"input",7),p("ngModelChange",function(i){return m(n.novaMadeira.tamanho.comprimento,i)||(n.novaMadeira.tamanho.comprimento=i),i}),r(),o(10,"select",8),p("ngModelChange",function(i){return m(n.novaMadeira.tamanho.espessura,i)||(n.novaMadeira.tamanho.espessura=i),i}),o(11,"option",9),s(12,"Espessura"),r(),h(13,se,2,2,"option",5),r(),o(14,"input",10),p("ngModelChange",function(i){return m(n.novaMadeira.tamanho.largura,i)||(n.novaMadeira.tamanho.largura=i),i}),r()(),o(15,"input",11),p("ngModelChange",function(i){return m(n.novaMadeira.quantidade,i)||(n.novaMadeira.quantidade=i),i}),r(),o(16,"button",12),s(17,"Adicionar"),r()(),o(18,"div",13)(19,"input",14),p("ngModelChange",function(i){return m(n.termoBusca,i)||(n.termoBusca=i),i}),f("input",function(){return n.buscarMadeira()}),r()(),o(20,"form",13)(21,"button",15),s(22,"Adicionar nova Madeira"),r()(),o(23,"div",16)(24,"table",17)(25,"thead")(26,"tr")(27,"th"),s(28,"Nome"),r(),o(29,"th"),s(30,"Tamanho"),r(),o(31,"th"),s(32,"Quantidade"),r(),o(33,"th"),s(34,"A\xE7\xF5es"),r()()(),o(35,"tbody"),h(36,le,12,5,"tr",18),r()()()(),h(37,pe,28,7,"div",19)),e&2&&(l(4),c("ngModel",n.novaMadeira.nome),l(3),u("ngForOf",n.catalogoMDF_MDP),l(2),c("ngModel",n.novaMadeira.tamanho.comprimento),l(),c("ngModel",n.novaMadeira.tamanho.espessura),l(3),u("ngForOf",n.espessurasMDF_MDP),l(),c("ngModel",n.novaMadeira.tamanho.largura),l(),c("ngModel",n.novaMadeira.quantidade),l(4),c("ngModel",n.termoBusca),l(17),u("ngForOf",n.madeiras),l(),u("ngIf",n.editarando))},dependencies:[j,B,z,ee,H,Z,J,A,X,Y,$,Q,K,U,G],styles:['.controle[_ngcontent-%COMP%]{background-color:#f9f9f9;margin:20px;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;display:flex;align-items:center;flex-direction:column;justify-content:center}.controle_title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.controle_title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.controle_container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;flex-direction:row;width:100%;gap:10px;margin-bottom:20px}.controle_container_input[_ngcontent-%COMP%]{background-color:#fff;color:#333;border:1px solid #ccc;width:100%;padding:10px;font-size:14px;border-radius:4px;appearance:none;-webkit-appearance:none;-moz-appearance:none;box-sizing:border-box;outline:none;transition:border-color .2s}.controle_container_input[_ngcontent-%COMP%]:focus{border-color:#2196f3}.controle_container_input[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#222}.controle_container_tamanho[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;gap:10px}.form-input-search[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:4px;font-size:14px;display:flex;flex-direction:row;width:100%}.input-tamanho[_ngcontent-%COMP%]{width:80px}.input-quantidade[_ngcontent-%COMP%]{width:100px}.input-search[_ngcontent-%COMP%]{flex:1;min-width:150px}.select-madeira[_ngcontent-%COMP%]{min-width:120px}.tamanho-separador[_ngcontent-%COMP%]{margin:0 5px}.btn-adicionar[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%], .btn-add[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s}.btn-add[_ngcontent-%COMP%]{background-color:gray;color:#fff;width:100%}.btn-search[_ngcontent-%COMP%]{width:17.5%}.btn-adicionar[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-adicionar[_ngcontent-%COMP%]:hover, .btn-salvar[_ngcontent-%COMP%]:hover{background-color:#45a049}.btn-search[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff}.btn-search[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-editar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;margin:0 8px}.btn-editar[_ngcontent-%COMP%]:hover{background-color:#0b7dda}.btn-excluir[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;margin:0 8px}.btn-excluir[_ngcontent-%COMP%]:hover, .btn-cancelar[_ngcontent-%COMP%]:hover{background-color:#da190b}.scrollable-table[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto;margin-top:20px}.tabela-madeiras[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabela-madeiras[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.tabela-madeiras[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2;color:#333;width:20vw}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.tabela-madeiras[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:999;padding:10px}.modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:20px;max-width:750px;width:100%;box-shadow:0 6px 20px #00000040;animation:_ngcontent-%COMP%_slideIn .3s ease-in-out;display:flex;flex-direction:column}.modal-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;text-transform:uppercase;text-align:center;color:#222;margin-bottom:20px;position:relative;display:inline-block;letter-spacing:1px}.modal-title[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:4px;background-color:#f39c12;border-radius:2px;transition:width .4s ease}.modal-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px;font-weight:700;color:#444}.modal_label_div[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;justify-content:center}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:10px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}@media (max-width: 800px){.modal-content[_ngcontent-%COMP%]{max-width:98vw}.tabela-madeiras[_ngcontent-%COMP%]{min-width:400px}}@media (max-width: 600px){.painel-madeiras[_ngcontent-%COMP%], .modal-content[_ngcontent-%COMP%]{padding:10px}.form-madeira[_ngcontent-%COMP%], .form-search[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%], .tamanho-group[_ngcontent-%COMP%], .input-tamanho[_ngcontent-%COMP%], .input-quantidade[_ngcontent-%COMP%], .input-search[_ngcontent-%COMP%], .select-madeira[_ngcontent-%COMP%]{width:100%;min-width:unset}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-adicionar[_ngcontent-%COMP%], .btn-search[_ngcontent-%COMP%], .btn-editar[_ngcontent-%COMP%], .btn-excluir[_ngcontent-%COMP%], .btn-salvar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%]{width:100%;margin:5px 0}}']})};export{ae as MadeirasComponent};
